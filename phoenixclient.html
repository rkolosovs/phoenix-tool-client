<!DOCTYPE html>
<html>
<head>
	<title>Phoenix Tool Client Application</title>
	<link rel="stylesheet" href="phoenixclient.css">
	<meta charset="utf-8"/>
</head>
<body oncontextmenu="return false;">
	<canvas id="hexCanvas"></canvas>
	<script src="jquery-2.2.3.js"></script>
	<script src="phoenixclient.js"></script>
	<script src="armies/army.js"></script>
	<script src="armies/armyCoordinates.js"></script>
	<script src="armyCollector.js"></script>
	<script src="gameState.js"></script>

	<div id="buttonsBox">
		<h3 align="center">Some Controll Buttons Go Here!</h3>
		<button id="ToggleGodModeBar" onclick="toggleGodModeBar()">toggle GodMode Bar</button>
</div>
	<div id="infoBox">
		<h3 align="center">Army Info Goes Here!</h3>
		<p id="armySelectBtns"></p>
		<p id="armyId"></p>
		<p id="count"></p>
		<p id="leaders"></p>
		<p id="mounts"></p>
		<p id="lkp"></p>
		<p id="skp"></p>
		<p id="movePoints"></p>
		<p id ="heightPoints"></p>
		<button id="logoutBtn" onclick="logoutFromServer()">Logout</button>
	</div>
	<div id="loginBox">
		<h3 align="center">Login</h3>
		<label for="loginName">Name:</label>
		<input id="loginName">
		<label for="loginPassword">Passwort:</label>
		<input id="loginPassword" type="password">
		<button id="loginBtn" onclick="loginToServer()">Login</button>
	</div>
	<div id="minimapBox">
		<h3 align="center">Minimap Goes Here!</h3>
	</div>
	<div id="godmodeBox">
		<h3 align="center">Godmode Box</h3>
		<button id="ToggleWorldCreationMode" onclick="toggleWorldCreationMode()">toggle World Creation Mode</button>
		<button id="ToggleBuildingCreationMode" onclick="toggleBuildingCreationMode()">toggle Building Creation Mode</button>
		<button id="ToggleStreetBuildingMode" onclick="toggleStreetBuildingMode()">toggle Street Building Mode</button>
		<button id="ToggleWallBuildingMode" onclick="toggleWallBuildingMode()">toggle Wall Building Mode</button>
		<button id="ToggleHarborBuildingMode" onclick="toggleHarborBuildingMode()">toggle Harbor Building Mode</button>
		<button id="ToggleBridgeBuildingMode" onclick="toggleBridgeBuildingMode()">toggle Bridge Building Mode</button>
		<button id="SaveFields" onclick="saveFields()">save Fields</button>
		<button id="SaveRivers" onclick="saveRivers()">save Rivers</button>
		<button id="SaveBuildings" onclick="saveBuildings()">save Buildings</button>
		<button id="SaveArmies" onclick="saveArmies()">save Armies</button>
		<button id="saveFactionsTerritories" onclick="saveFactionsTerritories()">save Factions Territories</button>

	</div>
	<div id="worldBenderBox">
		<h3 id="creationWarning" align="center">WARNING: WORLD CREATION ON CLICK MODE IS ACTIVE !!!</h3>
		<button id="ToggleOnClickWorldCreationMode" onclick="toggleOnClickWorldCreationMode()">toggle on click World Creation Mode</button>
		<section id="buildRiverSection">
			<button id="addRiverNW" onclick="addRiver(0)">Add a River at the north west border</button>
			<button id="addRiverNE" onclick="addRiver(1)">Add a River at the north east border</button>
			<button id="addRiverE" onclick="addRiver(2)">Add a River at the east border</button>
			<button id="addRiverSE" onclick="addRiver(3)">Add a River at the south east border</button>
			<button id="addRiverSW" onclick="addRiver(4)">Add a River at the south west border</button>
			<button id="addRiverW" onclick="addRiver(5)">Add a River at the west border</button>
		</section>
		<section id="removeRiverSection">
			<button id="removeRiverNW" onclick="removeRiver(0)">Remove a River at the north west border</button>
			<button id="removeRiverNE" onclick="removeRiver(1)">Remove a River at the north east border</button>
			<button id="removeRiverE" onclick="removeRiver(2)">Remove a River at the east border</button>
			<button id="removeRiverSE" onclick="removeRiver(3)">Remove a River at the south east border</button>
			<button id="removeRiverSW" onclick="removeRiver(4)">Remove a River at the south west border</button>
			<button id="removeRiverW" onclick="removeRiver(5)">Remove a River at the west border</button>
		</section>
	</div>
	<div id="buildingCreationBox">
		<button id="addCastle" onclick="addCastle()">Build a castle</button>
		<button id="addCity" onclick="addCity()">Build a city</button>
		<button id="addFortress" onclick="addFortress()">Build a fortress</button>
		<button id="addCapital" onclick="addCapital()">Build a capital</button>
		<button id="addCapitalFortress" onclick="addCapitalFortress()">Build a capital fortress</button>
		<button id="deleteBuilding" onclick="deleteBuilding()">Delete a building</button>
	</div>
	<div id="wallCreationBox">
		<h3 align="center">Wall Builder</h3>
		<section id="buildWall">
			<button id="addWallNW" onclick="manipulateBorderBuilding(5, 'nw', true)">Build a Wall in north west direction</button>
			<button id="addWallNE" onclick="manipulateBorderBuilding(5, 'ne', true)">Build a Wall in north east direction</button>
			<button id="addWallE" onclick="manipulateBorderBuilding(5, 'e', true)">Build a Wall in east direction</button>
			<button id="addWallSE" onclick="manipulateBorderBuilding(5, 'se', true)">Build a Wall in south east direction</button>
			<button id="addWallSW" onclick="manipulateBorderBuilding(5, 'sw', true)">Build a Wall in south west direction</button>
			<button id="addWallW" onclick="manipulateBorderBuilding(5, 'w', true)">Build a Wall in west direction</button>
		</section>
		<section id="removeWall">
			<button id="removeWallNW" onclick="manipulateBorderBuilding(5, 'nw', false)">Remove a Wall in north west direction</button>
			<button id="removeWallNE" onclick="manipulateBorderBuilding(5, 'ne', false)">Remove a Wall in north east direction</button>
			<button id="removeWallE" onclick="manipulateBorderBuilding(5, 'e', false)">Remove a Wall in east direction</button>
			<button id="removeWallSE" onclick="manipulateBorderBuilding(5, 'se', false)">Remove a Wall in south east direction</button>
			<button id="removeWallSW" onclick="manipulateBorderBuilding(5, 'sw', false)">Remove a Wall in south west direction</button>
			<button id="removeWallW" onclick="manipulateBorderBuilding(5, 'w', false)">Remove a Wall in west direction</button>
		</section>
	</div>
	<div id="harborCreationBox">
		<h3 align="center">Harbor Builder</h3>
		<section id="buildHarbor">
			<button id="addHarborNW" onclick="manipulateBorderBuilding(6, 'nw', true)">Build a Harbor in north west direction</button>
			<button id="addHarborNE" onclick="manipulateBorderBuilding(6, 'ne', true)">Build a Harbor in north east direction</button>
			<button id="addHarborE" onclick="manipulateBorderBuilding(6, 'e', true)">Build a Harbor in east direction</button>
			<button id="addHarborSE" onclick="manipulateBorderBuilding(6, 'se', true)">Build a Harbor in south east direction</button>
			<button id="addHarborSW" onclick="manipulateBorderBuilding(6, 'sw', true)">Build a Harbor in south west direction</button>
			<button id="addHarborW" onclick="manipulateBorderBuilding(6, 'w', true)">Build a Harbor in west direction</button>
		</section>
		<section id="removeHarbor">
			<button id="removeHarborNW" onclick="manipulateBorderBuilding(6, 'nw', false)">Remove a Harbor in north west direction</button>
			<button id="removeHarborNE" onclick="manipulateBorderBuilding(6, 'ne', false)">Remove a Harbor in north east direction</button>
			<button id="removeHarborE" onclick="manipulateBorderBuilding(6, 'e', false)">Remove a Harbor in east direction</button>
			<button id="removeHarborSE" onclick="manipulateBorderBuilding(6, 'se', false)">Remove a Harbor in south east direction</button>
			<button id="removeHarborSW" onclick="manipulateBorderBuilding(6, 'sw', false)">Remove a Harbor in south west direction</button>
			<button id="removeHarborW" onclick="manipulateBorderBuilding(6, 'w', false)">Remove a Harbor in west direction</button>
		</section>
	</div>
	<div id="bridgeCreationBox">
		<h3 align="center">Bridge Builder</h3>
		<section id="buildBridge">
			<button id="addBridgeNW" onclick="manipulateBorderBuilding(7, 'nw', true)">Build a Bridge in north west direction</button>
			<button id="addBridgeNE" onclick="manipulateBorderBuilding(7, 'ne', true)">Build a Bridge in north east direction</button>
			<button id="addBridgeE" onclick="manipulateBorderBuilding(7, 'e', true)">Build a Bridge in east direction</button>
			<button id="addBridgeSE" onclick="manipulateBorderBuilding(7, 'se', true)">Build a Bridge in south east direction</button>
			<button id="addBridgeSW" onclick="manipulateBorderBuilding(7, 'sw', true)">Build a Bridge in south west direction</button>
			<button id="addBridgeW" onclick="manipulateBorderBuilding(7, 'w', true)">Build a Bridge in west direction</button>
		</section>
		<section id="removeBridge">
			<button id="removeBridgeNW" onclick="manipulateBorderBuilding(7, 'nw', false)">Remove a Bridge in north west direction</button>
			<button id="removeBridgeNE" onclick="manipulateBorderBuilding(7, 'ne', false)">Remove a Bridge in north east direction</button>
			<button id="removeBridgeE" onclick="manipulateBorderBuilding(7, 'e', false)">Remove a Bridge in east direction</button>
			<button id="removeBridgeSE" onclick="manipulateBorderBuilding(7, 'se', false)">Remove a Bridge in south east direction</button>
			<button id="removeBridgeSW" onclick="manipulateBorderBuilding(7, 'sw', false)">Remove a Bridge in south west direction</button>
			<button id="removeBridgeW" onclick="manipulateBorderBuilding(7, 'w', false)">Remove a Bridge in west direction</button>
		</section>
	</div>
	<div id="streetCreationBox">
		<h3 align="center">Street Builder</h3>
		<section id="buildStreetSection">
			<button id="addStreetNW" onclick="addStreet(0)">Build a Street in north west direction</button>
			<button id="addStreetNE" onclick="addStreet(1)">Build a Street in north east direction</button>
			<button id="addStreetE" onclick="addStreet(2)">Build a Street in east direction</button>
			<button id="addStreetSE" onclick="addStreet(3)">Build a Street in south east direction</button>
			<button id="addStreetSW" onclick="addStreet(4)">Build a Street in south west direction</button>
			<button id="addStreetW" onclick="addStreet(5)">Build a Street in west direction</button>
		</section>
		<section id="removeStreetSection">
			<button id="removeStreetNW" onclick="removeStreet(0)">Remove a Street in north west direction</button>
			<button id="removeStreetNE" onclick="removeStreet(1)">Remove a Street in north east direction</button>
			<button id="removeStreetE" onclick="removeStreet(2)">Remove a Street in east direction</button>
			<button id="removeStreetSE" onclick="removeStreet(3)">Remove a Street in south east direction</button>
			<button id="removeStreetSW" onclick="removeStreet(4)">Remove a Street in south west direction</button>
			<button id="removeStreetW" onclick="removeStreet(5)">Remove a Street in west direction</button>
		</section>
	</div>

	<script>
		//TODO: Move all of this out of the .html file.
		var address = "http://phoenixserver.h2610265.stratoserver.net"; //the address of the remote server goes here
		// var address = "http://localhost:8000"; //the address of the remote server goes here
		authenticationToken = 0; // the session Token, default = 0.
		var worldCreationModeOn = false;
		var worldCreationModeOnClick = false;
		var buildingCreationModeOn = false;
		var streetBuildingModeOn = false;
		document.getElementById("godmodeBox").style.visibility = "hidden";
		document.getElementById("worldBenderBox").style.display = "none";
		document.getElementById("creationWarning").style.display = "none";
		document.getElementById("buildingCreationBox").style.display = "none";
		document.getElementById("streetCreationBox").style.display = "none";
		var harborBuildingModeOn = false;
		document.getElementById("harborCreationBox").style.display = "none";
		var bridgeBuildingModeOn = false;
		document.getElementById("bridgeCreationBox").style.display = "none";
		var wallBuildingModeOn = false;
		document.getElementById("wallCreationBox").style.display = "none";
		document.getElementById("infoBox").style.display = "none";

		function toggleGodModeBar(){
			if(document.getElementById("godmodeBox").style.visibility == "hidden"){
				document.getElementById("godmodeBox").style.visibility = "visible";
			} else if(document.getElementById("godmodeBox").style.visibility == "visible"){
				document.getElementById("godmodeBox").style.visibility = "hidden";
			}
		}

		function toggleWorldCreationMode(){
			if(worldCreationModeOn){
				worldCreationModeOn = false;
				worldCreationModeOnClick = false;
				document.getElementById("worldBenderBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "";
			} else if (!worldCreationModeOn){
				worldCreationModeOn = true;
				buildingCreationModeOn = false;
				streetBuildingModeOn = false;
				document.getElementById("worldBenderBox").style.display = "";
				document.getElementById("buildingCreationBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "none";
				document.getElementById("streetCreationBox").style.display = "none";
				document.getElementById("creationWarning").style.display = "none";
				var harborBuildingModeOn = false;
				document.getElementById("harborCreationBox").style.display = "none";
				var bridgeBuildingModeOn = false;
				document.getElementById("bridgeCreationBox").style.display = "none";
				var wallBuildingModeOn = false;
				document.getElementById("wallCreationBox").style.display = "none";
			}
		}

		function toggleOnClickWorldCreationMode(){
			if(worldCreationModeOnClick){
				worldCreationModeOnClick = false;
				document.getElementById("creationWarning").style.display = "none";
			} else if (!worldCreationModeOnClick){
				worldCreationModeOnClick = true;
				document.getElementById("creationWarning").style.display = "";
			}
		}

		function toggleBuildingCreationMode(){
			if(buildingCreationModeOn){
				buildingCreationModeOn = false;
				document.getElementById("buildingCreationBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "";
			} else if (!buildingCreationModeOn){
				buildingCreationModeOn = true;
				worldCreationModeOn = false;
				worldCreationModeOnClick = false;
				streetBuildingModeOn = false;
				document.getElementById("buildingCreationBox").style.display = "";
				document.getElementById("worldBenderBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "none";
				document.getElementById("streetCreationBox").style.display = "none";
				document.getElementById("creationWarning").style.display = "none";
				var harborBuildingModeOn = false;
				document.getElementById("harborCreationBox").style.display = "none";
				var bridgeBuildingModeOn = false;
				document.getElementById("bridgeCreationBox").style.display = "none";
				var wallBuildingModeOn = false;
				document.getElementById("wallCreationBox").style.display = "none";
			}
		}
		
		function toggleStreetBuildingMode(){
			if(streetBuildingModeOn){
				streetBuildingModeOn = false;
				document.getElementById("streetCreationBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "";
			} else if (!streetBuildingModeOn){
				buildingCreationModeOn = false;
				worldCreationModeOn = false;
				worldCreationModeOnClick = false;
				streetBuildingModeOn = true;
				document.getElementById("buildingCreationBox").style.display = "none";
				document.getElementById("worldBenderBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "none";
				document.getElementById("streetCreationBox").style.display = "";
				document.getElementById("creationWarning").style.display = "none";
				var harborBuildingModeOn = false;
				document.getElementById("harborCreationBox").style.display = "none";
				var bridgeBuildingModeOn = false;
				document.getElementById("bridgeCreationBox").style.display = "none";
				var wallBuildingModeOn = false;
				document.getElementById("wallCreationBox").style.display = "none";
			}
		}

		function toggleHarborBuildingMode(){
			if(harborBuildingModeOn){
				harborBuildingModeOn = false;
				document.getElementById("harborCreationBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "";
			} else if (!harborBuildingModeOn){
				buildingCreationModeOn = false;
				worldCreationModeOn = false;
				worldCreationModeOnClick = false;
				streetBuildingModeOn = false;
				document.getElementById("buildingCreationBox").style.display = "none";
				document.getElementById("worldBenderBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "none";
				document.getElementById("streetCreationBox").style.display = "none";
				document.getElementById("creationWarning").style.display = "none";
				var harborBuildingModeOn = true;
				document.getElementById("harborCreationBox").style.display = "";
				var bridgeBuildingModeOn = false;
				document.getElementById("bridgeCreationBox").style.display = "none";
				var wallBuildingModeOn = false;
				document.getElementById("wallCreationBox").style.display = "none";
			}
		}

		function toggleBridgeBuildingMode(){
			if(bridgeBuildingModeOn){
				bridgeBuildingModeOn = false;
				document.getElementById("bridgeCreationBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "";
			} else if (!bridgeBuildingModeOn){
				buildingCreationModeOn = false;
				worldCreationModeOn = false;
				worldCreationModeOnClick = false;
				streetBuildingModeOn = false;
				document.getElementById("buildingCreationBox").style.display = "none";
				document.getElementById("worldBenderBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "none";
				document.getElementById("streetCreationBox").style.display = "none";
				document.getElementById("creationWarning").style.display = "none";
				var harborBuildingModeOn = false;
				document.getElementById("harborCreationBox").style.display = "none";
				var bridgeBuildingModeOn = true;
				document.getElementById("bridgeCreationBox").style.display = "";
				var wallBuildingModeOn = false;
				document.getElementById("wallCreationBox").style.display = "none";
			}
		}

		function toggleWallBuildingMode(){
			if(wallBuildingModeOn){
				wallBuildingModeOn = false;
				document.getElementById("wallCreationBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "";
			} else if (!wallBuildingModeOn){
				buildingCreationModeOn = false;
				worldCreationModeOn = false;
				worldCreationModeOnClick = false;
				streetBuildingModeOn = false;
				document.getElementById("buildingCreationBox").style.display = "none";
				document.getElementById("worldBenderBox").style.display = "none";
				document.getElementById("buttonsBox").style.display = "none";
				document.getElementById("streetCreationBox").style.display = "none";
				document.getElementById("creationWarning").style.display = "none";
				var harborBuildingModeOn = false;
				document.getElementById("harborCreationBox").style.display = "none";
				var bridgeBuildingModeOn = false;
				document.getElementById("bridgeCreationBox").style.display = "none";
				var wallBuildingModeOn = true;
				document.getElementById("wallCreationBox").style.display = "";
			}
		}

		function addCastle(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 0;
					found = true;
				}
			}
			var building = {"type": 0, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function addCity(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 1;
					found = true;
				}
			}
			var building = {"type": 1, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function addFortress(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 2;
					found = true;
				}
			}
			var building = {"type": 2, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function addCapital(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 3;
					found = true;
				}
			}
			var building = {"type": 3, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function addCapitalFortress(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 4;
					found = true;
				}
			}
			var building = {"type": 4, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function deleteBuilding(){
			var sf = selectedFields[0];
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i];
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					if(i == buildings.length-1){
						delete buildings[i];
					}else{
						buildings[i] = buildings.pop();
					}
				}
			}
		}

		function addStreet(direction){
			var sf = selectedFields[0];
			var field = new showHex(sf[0], sf[1]);
			var targets = field.neighbors();
			var target = targets[direction];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i];
				if(building.type == 8 && ((building.first[0] == sf[0] && building.first[1] == sf[1] && building.second[0] == target[0] && building.second[1] == target[1]) || 
				(building.first[0] == target[0] && building.first[1] == target[1] && building.second[0] == sf[0] && building.second[1] == sf[1]))){
					found = true;
				}
			}
			var building = {"type": 8, "first": [sf[0], sf[1]], "second": [target[0], target[1]]};
			if(found){
			} else {
				buildings.push(building);
				selectedFields[0]=[target[0], target[1]];
			}
		}

		function removeStreet(direction){
			var sf = selectedFields[0];
			var field = new showHex(sf[0], sf[1]);
			var targets = field.neighbors();
			var target = targets[direction];
			var found = undefined;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i];
				if(building.type == 8 && ((building.first[0] == sf[0] && building.first[1] == sf[1] && building.second[0] == target[0] && building.second[1] == target[1]) || 
				(building.first[0] == target[0] && building.first[1] == target[1] && building.second[0] == sf[0] && building.second[1] == sf[1]))){
					found = i;
				}
			}
			if(found != undefined){
				if(found == buildings.length-1){
					buildings.pop();
					selectedFields[0]=[target[0], target[1]];
				} else {
					buildings[found] = buildings.pop();
					selectedFields[0]=[target[0], target[1]];
				}
			}
		}

		function addRiver(direction){
			var sf = selectedFields[0];
			var field = new showHex(sf[0], sf[1]);
			var targets = field.neighbors();
			var target = targets[direction];
			var found = false;
			for(var i = 0; i < rivers.length; i++){
				var river = rivers[i];
				if((river[0][0] == sf[0] && river[0][1] == sf[1] && river[1][0] == target[0] && river[1][1] == target[1] ) || 
				(river[1][0] == sf[0] && river[1][1] == sf[1] && river[0][0] == target[0] && river[0][1] == target[1])){
					found = true;
				}
			}
			if(found){
			} else {
				rivers.push([[sf[0],sf[1]],[target[0],target[1]]]);
			}
		}

		function removeRiver(direction){
			var sf = selectedFields[0];
			var field = new showHex(sf[0], sf[1]);
			var targets = field.neighbors();
			var target = targets[direction];
			var found = undefined;
			for(var i = 0; i < rivers.length; i++){
				var river = rivers[i];
				if((river[0][0] == sf[0] && river[0][1] == sf[1] && river[1][0] == target[0] && river[1][1] == target[1] ) || 
				(river[1][0] == sf[0] && river[1][1] == sf[1] && river[0][0] == target[0] && river[0][1] == target[1])){
					found = i;
				}
			}
			if(found != undefined){
				if(found == rivers.length-1){
					rivers.pop();
				} else {
					rivers[found] = rivers.pop();
				}
			}
		}

		//add = true means add a building, else remove it.
		function manipulateBorderBuilding(type, direction, add){
			var sf = selectedFields[0];
			var found = undefined;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i];
				if(building.type == type && (building.x == sf[0] && building.y == sf[1] && building.direction == direction)){
					found = i;
				}
			}
			if(add){
				var building = {"type": type, "x": sf[0], "y": sf[1], "direction": direction};
				if(found){
				} else {
					buildings.push(building);
				}
			} else {
				if(found != undefined){
					if(found == buildings.length-1){
						buildings.pop();
					}else{
						buildings[found] = buildings.pop();
					}
				}
			}
		}
		

		function getCookie(c_name)
		{
   			if (document.cookie.length > 0)
    		{
        		c_start = document.cookie.indexOf(c_name + "=");
        		if (c_start != -1)
        		{
        			c_start = c_start + c_name.length + 1;
        		    c_end = document.cookie.indexOf(";", c_start);
        		    if (c_end == -1) c_end = document.cookie.length;
        		    return unescape(document.cookie.substring(c_start,c_end));
        		}
    		}
    		return "";
 		}

		function saveFields(){ // saves the current fields on the server
			$(function () {
    			$.ajaxSetup({
        			headers: { "X-CSRFToken": currentCSRFToken} // getCookie("csrftoken")
    			});
			});
			var dataToServerString = "";
			for(var i = 0; i < fields.length; i++){
				if(i != fields.length-1){
					dataToServerString = dataToServerString + fields[i].type + ","
					dataToServerString = dataToServerString + fields[i].x + ","
					dataToServerString = dataToServerString + fields[i].y + ";"
				} else {
					dataToServerString = dataToServerString + fields[i].type + ","
					dataToServerString = dataToServerString + fields[i].x + ","
					dataToServerString = dataToServerString + fields[i].y
				}
			}
			console.log("start");
			console.log(fields);
			$.ajax({
				type: 'post',
				url: address+"/databaseLink/savefielddata/",
				data: {map: dataToServerString},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function saveRivers(){ // saves the current rivers on the server
			var dataToServerString = "";
			for(var i = 0; i < rivers.length; i++){
				if(i != rivers.length-1){
					dataToServerString = dataToServerString + rivers[i][0][0] + ","
					dataToServerString = dataToServerString + rivers[i][0][1] + ","
					dataToServerString = dataToServerString + rivers[i][1][0] + ","
					dataToServerString = dataToServerString + rivers[i][1][1] + ";"
				} else {
					dataToServerString = dataToServerString + rivers[i][0][0] + ","
					dataToServerString = dataToServerString + rivers[i][0][1] + ","
					dataToServerString = dataToServerString + rivers[i][1][0] + ","
					dataToServerString = dataToServerString + rivers[i][1][1]
				}
			}
			console.log("start");
			console.log(rivers);
			$.ajax({
				type:'post',
				url: address + "/databaseLink/saveriverdata/",
				data: {river: dataToServerString},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function saveBuildings(){ // saves the current buildings on the server
			var dataToServerString = "";
			for(var i = 0; i < buildings.length; i++){
				if(i != buildings.length-1){
					switch(buildings[i].type){
						case 1:
						case 2:
						case 3:
						case 4:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].x + ","
							dataToServerString = dataToServerString + buildings[i].y + ";"
							break
						case 5:
						case 6:
						case 7:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].x + ","
							dataToServerString = dataToServerString + buildings[i].y + ","
							dataToServerString = dataToServerString + buildings[i].direction + ";"
							break
						case 8:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].firstX + ","
							dataToServerString = dataToServerString + buildings[i].firstY + ","
							dataToServerString = dataToServerString + buildings[i].secondX + ","
							dataToServerString = dataToServerString + buildings[i].secondY + ";"
					}
				} else {switch(buildings[i].type){
						case 1:
						case 2:
						case 3:
						case 4:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].x + ","
							dataToServerString = dataToServerString + buildings[i].y
							break
						case 5:
						case 6:
						case 7:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].x + ","
							dataToServerString = dataToServerString + buildings[i].y + ","
							dataToServerString = dataToServerString + buildings[i].direction
							break
						case 8:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].firstX + ","
							dataToServerString = dataToServerString + buildings[i].firstY + ","
							dataToServerString = dataToServerString + buildings[i].secondX + ","
							dataToServerString = dataToServerString + buildings[i].secondY
					}
				}
			}
			console.log("start");
			console.log(buildings);
			$.ajax({
				type:'post',
				url: address + "/databaseLink/savebuildingdata/",
				data: {buildings: dataToServerString},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function saveArmies(){ // saves the current armies on the server
			var dataToServerString = "";
			for(var i = 0; i < listOfArmyCoordinates.length; i++){
				if(i != listOfArmyCoordinates.length-1){
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.armyId + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.count + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.leaders + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.lkp + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.skp + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.mounts + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].x + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].y + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].owner + ";"
				} else {
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.armyId + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.count + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.leaders + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.lkp + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.skp + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.mounts + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].x + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].y + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].owner
				}
			}
			console.log("start");
			console.log(listOfArmyCoordinates);
			$.ajax({
				type:'post',
				url: address + "/databaseLink/savearmydata/",
				data: {armies: dataToServerString},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function saveFactionsTerritories(){ // saves the territories on the server
			var dataToServerString = "";
			for (var i = 0; i < borders.length; i++) {
				if(i != borders.length-1){
					dataToServerString = dataToServerString + borders[i].tag + ":"
					for (var j = 0; j < borders[i].land.length; j++){
						if(j != borders[i].land.length-1){
							dataToServerString = dataToServerString + borders[i].land[j][0] + "/"
							dataToServerString = dataToServerString + borders[i].land[j][1] + ","
						} else {
							dataToServerString = dataToServerString + borders[i].land[j][0] + "/"
							dataToServerString = dataToServerString + borders[i].land[j][1] + ";"
						}
					}
				} else {
					dataToServerString = dataToServerString + borders[i].tag + ":"
					for (var j = 0; j < borders[i].land.length; j++){
						if(j != borders[i].land.length-1){
							dataToServerString = dataToServerString + borders[i].land[j][0] + "/"
							dataToServerString = dataToServerString + borders[i].land[j][1] + ","
						} else {
							dataToServerString = dataToServerString + borders[i].land[j][0] + "/"
							dataToServerString = dataToServerString + borders[i].land[j][1]
						}
					}
				}
			}
			console.log("start");
			console.log(borders);
			$.ajax({
				type:'post',
				url: address + "/databaseLink/saveborderdata/",
				data: {borders: dataToServerString},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function loginToServer(){
			var username = document.getElementById("loginName").value;
			var password = document.getElementById("loginPassword").value;
			$.post({
				url: address + "/databaseLink/login/",
				data: {username:username, password:password},
				success: function(data){
					console.log(data);
					authenticationToken = data.token;
					console.log(authenticationToken);
				},
				dataType: "json"
			});
			document.getElementById("infoBox").style.display = "";
			document.getElementById("loginBox").style.display = "none";
		}

		function logoutFromServer(){
			$.post({
				url: address + "/databaseLink/logout/"
			});
			document.getElementById("infoBox").style.display = "none";
			document.getElementById("loginBox").style.display = "";
		}

	</script>

	
</body>
</html>