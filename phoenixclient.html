<!DOCTYPE html>
<html>
<head>
	<title>Phoenix Tool Client Application</title>
	<link rel="stylesheet" href="phoenixclient.css">
	<meta charset="utf-8"/>
</head>
<body oncontextmenu="return false;">
	<canvas id="hexCanvas"></canvas>
	<script src="jquery-2.2.3.js"></script>
	<script src="phoenixclient.js"></script>
	<script src="armies/army.js"></script>
	<script src="armies/armyCoordinates.js"></script>
	<script src="armyCollector.js"></script>
	<script src="gameState.js"></script>

	<div id="buttonsBox">
		<h3 align="center">Some Controll Buttons Go Here!</h3>
		<button id="ToggleGodModeBar" onclick="toggleGodModeBar()">toggle GodMode Bar</button>
</div>
	<div id="infoBox">
		<p id="guard"></p>
		<p id="armyId"></p>
		<p id="count"></p>
		<p id="leaders"></p>
		<p id="mounts"></p>
		<p id="lkp"></p>
		<p id="skp"></p>
		<p id="movePoints"></p>
		<p id ="heightPoints"></p>
		<button id="mount" onclick="activateMountBox()">Aufsitzen</button>
		<button id="unMount" onclick="activateUnMountBox()">Absitzen</button>
		<button id="logoutBtn" onclick="logoutFromServer()">Logout</button>
	</div>
	<div id="mountBox">
		<p id="mountInputPartition">
			<label for="mountInput">Wie viele Soldaten sollen aufsitzen:</label>
			<input id="mountInput"></input>
		</p>
		<p id="mountInputLeaderPartition">
			<label for="mountLeaderInput">Wie viele Heerführer sollen zu Reiterheer:</label>
			<input id="mountLeaderInput"></input>
		</p>
		<button id="mount" onclick="mount()">Aufsitzen</button>
		<button id="allMount" onclick="allMount()">Alle aufsitzen</button>
		<button id="cancelMountUnMount" onclick="cancelMountUnMount()">Abbrechen</button>
	</div>
	<div id="unMountBox">
		<p id="unMountInputPartition">
			<label for="unMountInput">Wie viele Soldaten sollen absitzen:</label>
			<input id="unMountInput"></input>
		</p>
		<p id="unMountInputLeaderPartition">
			<label for="unMountLeaderInput">Wie viele Heerführer sollen zu Fußheer:</label>
			<input id="unMountLeaderInput"></input>
		</p>
		<button id="unMount" onclick="unMount()">Absitzen</button>
		<button id="allUnMount" onclick="allUnMount()">Alle absitzen</button>
		<button id="cancelMountUnMount" onclick="cancelMountUnMount()">Abbrechen</button>
	</div>
	<div id="infoChangeBox">
		<p id="ownerChange">
			<label for="ownerChangeInput">Besitzer:</label>
			<input id="ownerChangeInput"></input>
		</p>
		<p id="armyIdChange">
			<label for="armyIdChangeInput">HeeresId:</label>
			<input id="armyIdChangeInput"></input>
		</p>
		<p id="countChange">
			<label for="countChangeInput">anzahl Truppen:</label>
			<input id="countChangeInput"></input>
		</p>
		<p id="leadersChange">
			<label for="leadersChangeInput">anzahl Heerführer:</label>
			<input id="leadersChangeInput"></input>
		</p>
		<p id="mountsChange">
			<label for="mountsChangeInput">mitgeführte Reittiere:</label>
			<input id="mountsChangeInput"></input>
		</p>
		<p id="lkpChange">
			<label for="lkpChangeInput">leichte Katapulte:</label>
			<input id="lkpChangeInput"></input>
		</p>
		<p id="skpChange">
			<label for="skpChangeInput">schwere Katapulte:</label>
			<input id="skpChangeInput"></input>
		</p>
		<p id="movePointsChange">
			<label for="movePointsChangeInput">Bewegungspunkte:</label>
			<input id="movePointsChangeInput"></input>
		</p>
		<p id ="heightPointsChange">
			<label for="heightPointsChangeInput">Höhenpunkte:</label>
			<input id="heightPointsChangeInput"></input>
		</p>
		<button id="changeArmyInfo" onclick="changeArmyInfo()" visibility="none">Apply changed Stats</button>
		<button id="logoutBtnChange" onclick="logoutFromServer()">Logout</button>
	</div>
	<div id="loginBox">
		<h3 align="center">Login</h3>
		<label for="loginName">Name:</label>
		<input id="loginName">
		<label for="loginPassword">Passwort:</label>
		<input id="loginPassword" type="password">
		<button id="loginBtn" onclick="loginToServer()">Login</button>
	</div>
	<div id="minimapBox">
		<h3 align="center">Minimap Goes Here!</h3>
		<p id="timeTest"></p>
	</div>
	<div id="godmodeBox">
		<h3 align="center">Godmode Box</h3>
		<button id="ToggleWorldCreationMode" onclick="toggleWorldCreationMode()">modify fields</button>
		<button id="ToggleRiverCreationMode" onclick="toggleRiverCreationMode()">modify rivers</button>
		<button id="ToggleBuildingCreationMode" onclick="toggleBuildingCreationMode()">modify buildings</button>
		<button id="ToggleStreetBuildingMode" onclick="toggleStreetBuildingMode()">Modify streets</button>
		<button id="ToggleWallBuildingMode" onclick="toggleWallBuildingMode()">modify walls</button>
		<button id="ToggleHarborBuildingMode" onclick="toggleHarborBuildingMode()">modify harbours</button>
		<button id="ToggleBridgeBuildingMode" onclick="toggleBridgeBuildingMode()">modify bridges</button>
		<button id="SaveArmies" onclick="saveArmies()">save armies</button>
		<button id="SaveFactionsTerritories" onclick="saveFactionsTerritories()">save faction territories</button>
		<button id="ToggleArmyCreationMode" onclick="toggleArmyCreationMode()">make an Army</button>
	</div>
	<div id="armyGeneratorBox">
		<label for="ownerField">Reich:</label>
		<input id="ownerField" value="0">
		<label for="armyNumberField">Armee Nummer:</label>
		<input id="armyNumberField" value="0">
		<label for="countField" value="0">Truppenanzahl:</label>
		<input id="countField" value="0">
		<label for="leaderField">Heerführer:</label>
		<input id="leaderField" value="0">
		<label for="mountsField">Reittiere:</label>
		<input id="mountsField" value="0">
		<label for="lkpField">leichte Katapulte:</label>
		<input id="lkpField" value="0">
		<label for="skpField">schwere Katapulte:</label>
		<input id="skpField" value="0">
		<input type="checkbox" id="guardField" value="true">Garde?<br>
		<button id="GenerateArmyBtn" onclick="generateArmyBtn()">Armee Generieren</button>
	</div>
	<div id="worldBenderBox">
		<h3 id="creationWarning" align="center">WARNING: WORLD CREATION ON CLICK MODE IS ACTIVE !!!</h3>
		<button id="ToggleOnClickWorldCreationMode" onclick="toggleOnClickWorldCreationMode()">toggle on click World Creation Mode</button>
		<button id="SaveFields" onclick="saveFields()">save fields</button>
		<section id="changeFieldSection">
			<button id="ChangeFieldClickedTo0" onclick="changeFieldClickedTo(0)"> change field clicked to shallows</button>
			<button id="ChangeFieldClickedTo1" onclick="changeFieldClickedTo(1)"> change field clicked to deepsea</button>
			<button id="ChangeFieldClickedTo2" onclick="changeFieldClickedTo(2)"> change field clicked to lowlands</button>
			<button id="ChangeFieldClickedTo3" onclick="changeFieldClickedTo(3)"> change field clicked to woods</button>
			<button id="ChangeFieldClickedTo4" onclick="changeFieldClickedTo(4)"> change field clicked to hills</button>
			<button id="ChangeFieldClickedTo5" onclick="changeFieldClickedTo(5)"> change field clicked to highlands</button>
			<button id="ChangeFieldClickedTo6" onclick="changeFieldClickedTo(6)"> change field clicked to mountains</button>
			<button id="ChangeFieldClickedTo7" onclick="changeFieldClickedTo(7)"> change field clicked to desert</button>
			<button id="ChangeFieldClickedTo8" onclick="changeFieldClickedTo(8)"> change field clicked to swamp</button>
			<button id="ChangeFieldClickedTo9" onclick="changeFieldClickedTo(9)"> change field clicked to undefined</button>
		</section>
	</div>
	<div id="riverBenderBox">
		<section id="buildRiverSection">
			<button id="addRiverNW" onclick="addRiver(0)">Add a River at the north west border</button>
			<button id="addRiverNE" onclick="addRiver(1)">Add a River at the north east border</button>
			<button id="addRiverE" onclick="addRiver(2)">Add a River at the east border</button>
			<button id="addRiverSE" onclick="addRiver(3)">Add a River at the south east border</button>
			<button id="addRiverSW" onclick="addRiver(4)">Add a River at the south west border</button>
			<button id="addRiverW" onclick="addRiver(5)">Add a River at the west border</button>
		</section>
		<section id="removeRiverSection">
			<button id="removeRiverNW" onclick="removeRiver(0)">Remove a River at the north west border</button>
			<button id="removeRiverNE" onclick="removeRiver(1)">Remove a River at the north east border</button>
			<button id="removeRiverE" onclick="removeRiver(2)">Remove a River at the east border</button>
			<button id="removeRiverSE" onclick="removeRiver(3)">Remove a River at the south east border</button>
			<button id="removeRiverSW" onclick="removeRiver(4)">Remove a River at the south west border</button>
			<button id="removeRiverW" onclick="removeRiver(5)">Remove a River at the west border</button>
		</section>
		<button id="SaveRivers" onclick="saveRivers()">save rivers</button>
	</div>
	<div id="buildingCreationBox">
		<section id="buildingSection">
			<button id="addCastle" onclick="addCastle()">Build a castle</button>
			<button id="addCity" onclick="addCity()">Build a city</button>
			<button id="addFortress" onclick="addFortress()">Build a fortress</button>
			<button id="addCapital" onclick="addCapital()">Build a capital</button>
			<button id="addCapitalFortress" onclick="addCapitalFortress()">Build a capital fortress</button>
			<button id="deleteBuilding" onclick="deleteBuilding()">Delete a building</button>
		</section>
		<button id="SaveBuildings" onclick="saveBuildings()">save buildings</button>
	</div>
	<div id="wallCreationBox">
		<section id="buildWall">
			<button id="addWallNW" onclick="manipulateBorderBuilding(5, 'nw', true)">Build a Wall in north west direction</button>
			<button id="addWallNE" onclick="manipulateBorderBuilding(5, 'ne', true)">Build a Wall in north east direction</button>
			<button id="addWallE" onclick="manipulateBorderBuilding(5, 'e', true)">Build a Wall in east direction</button>
			<button id="addWallSE" onclick="manipulateBorderBuilding(5, 'se', true)">Build a Wall in south east direction</button>
			<button id="addWallSW" onclick="manipulateBorderBuilding(5, 'sw', true)">Build a Wall in south west direction</button>
			<button id="addWallW" onclick="manipulateBorderBuilding(5, 'w', true)">Build a Wall in west direction</button>
		</section>
		<section id="removeWall">
			<button id="removeWallNW" onclick="manipulateBorderBuilding(5, 'nw', false)">Remove a Wall in north west direction</button>
			<button id="removeWallNE" onclick="manipulateBorderBuilding(5, 'ne', false)">Remove a Wall in north east direction</button>
			<button id="removeWallE" onclick="manipulateBorderBuilding(5, 'e', false)">Remove a Wall in east direction</button>
			<button id="removeWallSE" onclick="manipulateBorderBuilding(5, 'se', false)">Remove a Wall in south east direction</button>
			<button id="removeWallSW" onclick="manipulateBorderBuilding(5, 'sw', false)">Remove a Wall in south west direction</button>
			<button id="removeWallW" onclick="manipulateBorderBuilding(5, 'w', false)">Remove a Wall in west direction</button>
		</section>
		<button id="SaveBuildings" onclick="saveBuildings()">save buildings</button>
	</div>
	<div id="harborCreationBox">
		<section id="buildHarbor">
			<button id="addHarborNW" onclick="manipulateBorderBuilding(6, 'nw', true)">Build a Harbor in north west direction</button>
			<button id="addHarborNE" onclick="manipulateBorderBuilding(6, 'ne', true)">Build a Harbor in north east direction</button>
			<button id="addHarborE" onclick="manipulateBorderBuilding(6, 'e', true)">Build a Harbor in east direction</button>
			<button id="addHarborSE" onclick="manipulateBorderBuilding(6, 'se', true)">Build a Harbor in south east direction</button>
			<button id="addHarborSW" onclick="manipulateBorderBuilding(6, 'sw', true)">Build a Harbor in south west direction</button>
			<button id="addHarborW" onclick="manipulateBorderBuilding(6, 'w', true)">Build a Harbor in west direction</button>
		</section>
		<section id="removeHarbor">
			<button id="removeHarborNW" onclick="manipulateBorderBuilding(6, 'nw', false)">Remove a Harbor in north west direction</button>
			<button id="removeHarborNE" onclick="manipulateBorderBuilding(6, 'ne', false)">Remove a Harbor in north east direction</button>
			<button id="removeHarborE" onclick="manipulateBorderBuilding(6, 'e', false)">Remove a Harbor in east direction</button>
			<button id="removeHarborSE" onclick="manipulateBorderBuilding(6, 'se', false)">Remove a Harbor in south east direction</button>
			<button id="removeHarborSW" onclick="manipulateBorderBuilding(6, 'sw', false)">Remove a Harbor in south west direction</button>
			<button id="removeHarborW" onclick="manipulateBorderBuilding(6, 'w', false)">Remove a Harbor in west direction</button>
		</section>
		<button id="SaveBuildings" onclick="saveBuildings()">save buildings</button>
	</div>
	<div id="bridgeCreationBox">
		<section id="buildBridge">
			<button id="addBridgeNW" onclick="manipulateBorderBuilding(7, 'nw', true)">Build a Bridge in north west direction</button>
			<button id="addBridgeNE" onclick="manipulateBorderBuilding(7, 'ne', true)">Build a Bridge in north east direction</button>
			<button id="addBridgeE" onclick="manipulateBorderBuilding(7, 'e', true)">Build a Bridge in east direction</button>
			<button id="addBridgeSE" onclick="manipulateBorderBuilding(7, 'se', true)">Build a Bridge in south east direction</button>
			<button id="addBridgeSW" onclick="manipulateBorderBuilding(7, 'sw', true)">Build a Bridge in south west direction</button>
			<button id="addBridgeW" onclick="manipulateBorderBuilding(7, 'w', true)">Build a Bridge in west direction</button>
		</section>
		<section id="removeBridge">
			<button id="removeBridgeNW" onclick="manipulateBorderBuilding(7, 'nw', false)">Remove a Bridge in north west direction</button>
			<button id="removeBridgeNE" onclick="manipulateBorderBuilding(7, 'ne', false)">Remove a Bridge in north east direction</button>
			<button id="removeBridgeE" onclick="manipulateBorderBuilding(7, 'e', false)">Remove a Bridge in east direction</button>
			<button id="removeBridgeSE" onclick="manipulateBorderBuilding(7, 'se', false)">Remove a Bridge in south east direction</button>
			<button id="removeBridgeSW" onclick="manipulateBorderBuilding(7, 'sw', false)">Remove a Bridge in south west direction</button>
			<button id="removeBridgeW" onclick="manipulateBorderBuilding(7, 'w', false)">Remove a Bridge in west direction</button>
		</section>
		<button id="SaveBuildings" onclick="saveBuildings()">save buildings</button>
	</div>
	<div id="streetCreationBox">
		<section id="buildStreetSection">
			<button id="addStreetNW" onclick="addStreet(0)">Build a Street in north west direction</button>
			<button id="addStreetNE" onclick="addStreet(1)">Build a Street in north east direction</button>
			<button id="addStreetE" onclick="addStreet(2)">Build a Street in east direction</button>
			<button id="addStreetSE" onclick="addStreet(3)">Build a Street in south east direction</button>
			<button id="addStreetSW" onclick="addStreet(4)">Build a Street in south west direction</button>
			<button id="addStreetW" onclick="addStreet(5)">Build a Street in west direction</button>
		</section>
		<section id="removeStreetSection">
			<button id="removeStreetNW" onclick="removeStreet(0)">Remove a Street in north west direction</button>
			<button id="removeStreetNE" onclick="removeStreet(1)">Remove a Street in north east direction</button>
			<button id="removeStreetE" onclick="removeStreet(2)">Remove a Street in east direction</button>
			<button id="removeStreetSE" onclick="removeStreet(3)">Remove a Street in south east direction</button>
			<button id="removeStreetSW" onclick="removeStreet(4)">Remove a Street in south west direction</button>
			<button id="removeStreetW" onclick="removeStreet(5)">Remove a Street in west direction</button>
		</section>
		<button id="SaveBuildings" onclick="saveBuildings()">save buildings</button>
	</div>

	<script>
		//TODO: Move all of this out of the .html file.
		var address = "http://phoenixserver.h2610265.stratoserver.net"; //the address of the remote server goes here
		// var address = "http://localhost:8000"; //the address of the remote server goes here
		var changedFields = []; // Fields that were changed with World Builder
		var authenticationToken = 0; // the session Token, default = 0.
		var worldCreationModeOn = false;
		var worldCreationModeOnClick = false;
		var riverCreationModeOn = false;
		var buildingCreationModeOn = false;
		var streetBuildingModeOn = false;
		var harborBuildingModeOn = false;
		var bridgeBuildingModeOn = false;
		var wallBuildingModeOn = false;
		var changeFieldToType = -1;
		var armyCreationModeOn = false;
		var armyWithNextClick = false;
		var ownerBuffer = 0;
		var armyIdBuffer = 0;
		var countBuffer = 0;
		var leaderBuffer = 0;
		var mountsBuffer = 0;
		var lkpBuffer = 0; 
		var skpBuffer = 0;
		var guardBuffer = false;
		document.getElementById("ToggleGodModeBar").style.display = "none";
		document.getElementById("godmodeBox").style.visibility = "hidden";
		document.getElementById("worldBenderBox").style.display = "none";
		document.getElementById("riverBenderBox").style.display = "none";
		document.getElementById("creationWarning").style.display = "none";
		document.getElementById("buildingCreationBox").style.display = "none";
		document.getElementById("streetCreationBox").style.display = "none";
		document.getElementById("harborCreationBox").style.display = "none";
		document.getElementById("bridgeCreationBox").style.display = "none";
		document.getElementById("wallCreationBox").style.display = "none";
		document.getElementById("infoBox").style.display = "none";
		document.getElementById("armyGeneratorBox").style.display = "none";
		document.getElementById("infoChangeBox").style.display = "none";
		document.getElementById("armyIdChange").style.display = "none";
		document.getElementById("mount").style.display = "none";
		document.getElementById("unMount").style.display = "none";
		document.getElementById("mountBox").style.display = "none";
		document.getElementById("unMountBox").style.display = "none";

		// switches bunttonBoxContent.style.visibility to "" and all others to "none"
		function switchBtnBoxTo(buttonBoxContent){
			document.getElementById("worldBenderBox").style.display = "none";
			document.getElementById("riverBenderBox").style.display = "none";
			document.getElementById("creationWarning").style.display = "none";
			document.getElementById("buildingCreationBox").style.display = "none";
			document.getElementById("streetCreationBox").style.display = "none";
			document.getElementById("harborCreationBox").style.display = "none";
			document.getElementById("bridgeCreationBox").style.display = "none";
			document.getElementById("wallCreationBox").style.display = "none";
			document.getElementById("buttonsBox").style.display = "none";
			document.getElementById("armyGeneratorBox").style.display = "none";
			document.getElementById(buttonBoxContent).style.display = "";
		}

		// switches activeMode to True and all others to false
		function switchModeTo(activeMode){
			worldCreationModeOn = false;
			worldCreationModeOnClick = false;
			riverCreationModeOn = false;
			buildingCreationModeOn = false;
			streetBuildingModeOn = false;
			harborBuildingModeOn = false;
			bridgeBuildingModeOn = false;
			wallBuildingModeOn = false;
			changeFieldToType = -1;
			armyWithNextClick = false;
			armyCreationModeOn = false;
			switch(activeMode){
				//worldCreationModeOnClick also has worldCreationModeOn enabled
				case "worldCreationModeOnClick": worldCreationModeOnClick = true;
				case "worldCreationModeOn": worldCreationModeOn = true; break;
				case "riverCreationModeOn": riverCreationModeOn = true; break;
				case "buildingCreationModeOn": buildingCreationModeOn = true; break;
				case "streetBuildingModeOn": streetBuildingModeOn = true; break;
				case "harborBuildingModeOn": harborBuildingModeOn = true; break;
				case "bridgeBuildingModeOn": bridgeBuildingModeOn = true; break;
				case "wallBuildingModeOn": wallBuildingModeOn = true; break;
				case "armyWithNextClick": armyWithNextClick = true; break;
				case "armyCreationModeOn": armyCreationModeOn = true; break;
				case "none": break;
				}
		}

		function toggleArmyCreationMode(){
			if(armyCreationModeOn){
				switchModeTo("none");
				switchBtnBoxTo("buttonsBox");
			} else if (!armyCreationModeOn){
				switchModeTo("armyCreationModeOn");
				switchBtnBoxTo("armyGeneratorBox");
			}
		}

		function changeFieldClickedTo(number){
			if(changeFieldToType != number){
				switchModeTo("worldCreationModeOnClick");
				changeFieldToType = number;
				document.getElementById("creationWarning").style.display = "";
			} else {
				changeFieldToType = -1;
				switchModeTo("worldCreationModeOn");
				document.getElementById("creationWarning").style.display = "none";
			}
		}

		function toggleGodModeBar(){
			if(document.getElementById("godmodeBox").style.visibility == "hidden"){
				cancelMountUnMount();
				document.getElementById("godmodeBox").style.visibility = "visible";
				document.getElementById("infoChangeBox").style.display = ""
				document.getElementById("infoBox").style.display = "none"
			} else if(document.getElementById("godmodeBox").style.visibility == "visible"){
				document.getElementById("godmodeBox").style.visibility = "hidden";
				document.getElementById("infoChangeBox").style.display = "none"
				document.getElementById("infoBox").style.display = ""
				updateInfoBox();
			}
		}

		function toggleWorldCreationMode(){
			if(worldCreationModeOn){
				switchModeTo("none");
				switchBtnBoxTo("buttonsBox");
			} else if (!worldCreationModeOn){
				switchModeTo("worldCreationModeOn");
				switchBtnBoxTo("worldBenderBox");
			}
		}

		function toggleOnClickWorldCreationMode(){
			if(worldCreationModeOnClick && (changeFieldToType == -1)){
				worldCreationModeOnClick = false;
				document.getElementById("creationWarning").style.display = "none";
			} else if (!worldCreationModeOnClick || (worldCreationModeOnClick && (changeFieldToType != -1))){
				changeFieldToType = -1;
				worldCreationModeOnClick = true;
				document.getElementById("creationWarning").style.display = "";
			}
		}

		function toggleRiverCreationMode(){
			if(riverCreationModeOn){
				switchModeTo("none");
				switchBtnBoxTo("buttonsBox");
			} else if (!riverCreationModeOn){
				switchModeTo("riverCreationModeOn");
				switchBtnBoxTo("riverBenderBox");
			}
		}

		function toggleBuildingCreationMode(){
			if(buildingCreationModeOn){
				switchModeTo("none");
				switchBtnBoxTo("buttonsBox");
			} else if (!buildingCreationModeOn){
				switchBtnBoxTo("buildingCreationBox");
				switchModeTo("buildingCreationModeOn");
			}
		}
		
		function toggleStreetBuildingMode(){
			if(streetBuildingModeOn){
				switchModeTo("none");
				switchBtnBoxTo("buttonsBox");
			} else if (!streetBuildingModeOn){
				switchModeTo("streetBuildingModeOn");
				switchBtnBoxTo("streetCreationBox");
			}
		}

		function toggleHarborBuildingMode(){
			if(harborBuildingModeOn){
				switchModeTo("none");
				switchBtnBoxTo("buttonsBox");
			} else if (!harborBuildingModeOn){
				switchModeTo("harborBuildingModeOn");
				switchBtnBoxTo("harborCreationBox");
			}
		}

		function toggleBridgeBuildingMode(){
			if(bridgeBuildingModeOn){
				switchModeTo("none");
				switchBtnBoxTo("buttonsBox");
			} else if (!bridgeBuildingModeOn){
				switchModeTo("bridgeBuildingModeOn");
				switchBtnBoxTo("bridgeCreationBox");
			}
		}

		function toggleWallBuildingMode(){
			if(wallBuildingModeOn){
				switchModeTo("none");
				switchBtnBoxTo("buttonsBox");
			} else if (!wallBuildingModeOn){
				switchModeTo("wallBuildingModeOn");
				switchBtnBoxTo("wallCreationBox");
			}
		}

		function addCastle(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 0;
					found = true;
				}
			}
			var building = {"type": 0, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function addCity(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 1;
					found = true;
				}
			}
			var building = {"type": 1, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function addFortress(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 2;
					found = true;
				}
			}
			var building = {"type": 2, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function addCapital(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 3;
					found = true;
				}
			}
			var building = {"type": 3, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function addCapitalFortress(){
			var sf = selectedFields[0];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i]
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					buildings[i].type = 4;
					found = true;
				}
			}
			var building = {"type": 4, "x": sf[0], "y": sf[1]};
			if(found){
			} else {
				buildings.push(building);
			}
		}

		function deleteBuilding(){
			var sf = selectedFields[0];
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i];
				if(building.type < 5 && building.x == sf[0] && building.y == sf[1]){
					if(i == buildings.length-1){
						delete buildings[i];
					}else{
						buildings[i] = buildings.pop();
					}
				}
			}
		}

		function addStreet(direction){
			var sf = selectedFields[0];
			var field = new showHex(sf[0], sf[1]);
			var targets = field.neighbors();
			var target = targets[direction];
			var found = false;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i];
				if(building.type == 8 && ((building.first[0] == sf[0] && building.first[1] == sf[1] && building.second[0] == target[0] && building.second[1] == target[1]) || 
				(building.first[0] == target[0] && building.first[1] == target[1] && building.second[0] == sf[0] && building.second[1] == sf[1]))){
					found = true;
				}
			}
			var building = {"type": 8, "first": [sf[0], sf[1]], "second": [target[0], target[1]]};
			if(found){
			} else {
				buildings.push(building);
				selectedFields[0]=[target[0], target[1]];
			}
		}

		function removeStreet(direction){
			var sf = selectedFields[0];
			var field = new showHex(sf[0], sf[1]);
			var targets = field.neighbors();
			var target = targets[direction];
			var found = undefined;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i];
				if(building.type == 8 && ((building.first[0] == sf[0] && building.first[1] == sf[1] && building.second[0] == target[0] && building.second[1] == target[1]) || 
				(building.first[0] == target[0] && building.first[1] == target[1] && building.second[0] == sf[0] && building.second[1] == sf[1]))){
					found = i;
				}
			}
			if(found != undefined){
				if(found == buildings.length-1){
					buildings.pop();
					selectedFields[0]=[target[0], target[1]];
				} else {
					buildings[found] = buildings.pop();
					selectedFields[0]=[target[0], target[1]];
				}
			}
		}

		function addRiver(direction){
			var sf = selectedFields[0];
			var field = new showHex(sf[0], sf[1]);
			var targets = field.neighbors();
			var target = targets[direction];
			var found = false;
			for(var i = 0; i < rivers.length; i++){
				var river = rivers[i];
				if((river[0][0] == sf[0] && river[0][1] == sf[1] && river[1][0] == target[0] && river[1][1] == target[1] ) || 
				(river[1][0] == sf[0] && river[1][1] == sf[1] && river[0][0] == target[0] && river[0][1] == target[1])){
					found = true;
				}
			}
			if(found){
			} else {
				rivers.push([[sf[0],sf[1]],[target[0],target[1]]]);
			}
		}

		function removeRiver(direction){
			var sf = selectedFields[0];
			var field = new showHex(sf[0], sf[1]);
			var targets = field.neighbors();
			var target = targets[direction];
			var found = undefined;
			for(var i = 0; i < rivers.length; i++){
				var river = rivers[i];
				if((river[0][0] == sf[0] && river[0][1] == sf[1] && river[1][0] == target[0] && river[1][1] == target[1] ) || 
				(river[1][0] == sf[0] && river[1][1] == sf[1] && river[0][0] == target[0] && river[0][1] == target[1])){
					found = i;
				}
			}
			if(found != undefined){
				if(found == rivers.length-1){
					rivers.pop();
				} else {
					rivers[found] = rivers.pop();
				}
			}
		}

		//add = true means add a building, else remove it.
		function manipulateBorderBuilding(type, direction, add){
			var sf = selectedFields[0];
			var found = undefined;
			for(var i = 0; i < buildings.length; i++){
				var building = buildings[i];
				if(building.type == type && (building.x == sf[0] && building.y == sf[1] && building.direction == direction)){
					found = i;
				}
			}
			if(add){
				var building = {"type": type, "x": sf[0], "y": sf[1], "direction": direction};
				if(found){
				} else {
					buildings.push(building);
				}
			} else {
				if(found != undefined){
					if(found == buildings.length-1){
						buildings.pop();
					}else{
						buildings[found] = buildings.pop();
					}
				}
			}
		}
		

		//function getCookie(c_name)
		//{
   		//	if (document.cookie.length > 0)
    	//	{
        //		c_start = document.cookie.indexOf(c_name + "=");
        //		if (c_start != -1)
        //		{
        // 			c_start = c_start + c_name.length + 1;
        //		    c_end = document.cookie.indexOf(";", c_start);
        //		    if (c_end == -1) c_end = document.cookie.length;
        //		    return unescape(document.cookie.substring(c_start,c_end));
        //		}
    	//	}
    	//	return "";
 		//}

		function saveFields(){ // saves the current fields on the server
			$(function () {
    			$.ajaxSetup({
        			headers: { "X-CSRFToken": currentCSRFToken} // getCookie("csrftoken")
    			});
			});
			var dataToServerString = "";
			for(var i = 0; i < changedFields.length; i++){
				if(i != changedFields.length-1){
					dataToServerString = dataToServerString + changedFields[i].type + ","
					dataToServerString = dataToServerString + changedFields[i].x + ","
					dataToServerString = dataToServerString + changedFields[i].y + ";"
				} else {
					dataToServerString = dataToServerString + changedFields[i].type + ","
					dataToServerString = dataToServerString + changedFields[i].x + ","
					dataToServerString = dataToServerString + changedFields[i].y
				}
			}
			console.log("start");
			console.log(changedFields);
			$.ajax({
				type: 'post',
				url: address+"/databaseLink/savefielddata/",
				data: {map: dataToServerString},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function saveRivers(){ // saves the current rivers on the server
			var dataToServerString = "";
			for(var i = 0; i < rivers.length; i++){
				if(i != rivers.length-1){
					dataToServerString = dataToServerString + rivers[i][0][0] + ","
					dataToServerString = dataToServerString + rivers[i][0][1] + ","
					dataToServerString = dataToServerString + rivers[i][1][0] + ","
					dataToServerString = dataToServerString + rivers[i][1][1] + ";"
				} else {
					dataToServerString = dataToServerString + rivers[i][0][0] + ","
					dataToServerString = dataToServerString + rivers[i][0][1] + ","
					dataToServerString = dataToServerString + rivers[i][1][0] + ","
					dataToServerString = dataToServerString + rivers[i][1][1]
				}
			}
			console.log("start");
			console.log(rivers);
			$.ajax({
				type:'post',
				url: address + "/databaseLink/saveriverdata/",
				data: {river: dataToServerString},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function saveBuildings(){ // saves the current buildings on the server
			var dataToServerString = "";
			for(var i = 0; i < buildings.length; i++){
				if(i != buildings.length-1){
					switch(buildings[i].type){
						case 1:
						case 2:
						case 3:
						case 4:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].x + ","
							dataToServerString = dataToServerString + buildings[i].y + ";"
							break
						case 5:
						case 6:
						case 7:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].x + ","
							dataToServerString = dataToServerString + buildings[i].y + ","
							dataToServerString = dataToServerString + buildings[i].direction + ";"
							break
						case 8:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].firstX + ","
							dataToServerString = dataToServerString + buildings[i].firstY + ","
							dataToServerString = dataToServerString + buildings[i].secondX + ","
							dataToServerString = dataToServerString + buildings[i].secondY + ";"
					}
				} else {switch(buildings[i].type){
						case 1:
						case 2:
						case 3:
						case 4:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].x + ","
							dataToServerString = dataToServerString + buildings[i].y
							break
						case 5:
						case 6:
						case 7:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].x + ","
							dataToServerString = dataToServerString + buildings[i].y + ","
							dataToServerString = dataToServerString + buildings[i].direction
							break
						case 8:
							dataToServerString = dataToServerString + buildings[i].type + ","
							dataToServerString = dataToServerString + buildings[i].reich + ","
							dataToServerString = dataToServerString + buildings[i].firstX + ","
							dataToServerString = dataToServerString + buildings[i].firstY + ","
							dataToServerString = dataToServerString + buildings[i].secondX + ","
							dataToServerString = dataToServerString + buildings[i].secondY
					}
				}
			}
			console.log("start");
			console.log(buildings);
			$.ajax({
				type:'post',
				url: address + "/databaseLink/savebuildingdata/",
				data: {buildings: dataToServerString},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function saveArmies(){ // saves the current armies on the server
			var dataToServerString = "";
			for(var i = 0; i < listOfArmyCoordinates.length; i++){
				if(i != listOfArmyCoordinates.length-1){
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.armyId + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.count + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.leaders + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.lkp + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.skp + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.mounts + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].x + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].y + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].owner + ";"
				} else {
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.armyId + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.count + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.leaders + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.lkp + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.skp + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].a.mounts + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].x + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].y + ","
					dataToServerString = dataToServerString + listOfArmyCoordinates[i].owner
				}
			}
			console.log("start");
			console.log(listOfArmyCoordinates);
			$.ajax({
				type:'post',
				url: address + "/databaseLink/savearmydata/",
				data: {armies: dataToServerString,
					authorization: authenticationToken},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function saveFactionsTerritories(){ // saves the territories on the server
			var dataToServerString = "";
			for (var i = 0; i < borders.length; i++) {
				if(i != borders.length-1){
					dataToServerString = dataToServerString + borders[i].tag + ":"
					for (var j = 0; j < borders[i].land.length; j++){
						if(j != borders[i].land.length-1){
							dataToServerString = dataToServerString + borders[i].land[j][0] + "/"
							dataToServerString = dataToServerString + borders[i].land[j][1] + ","
						} else {
							dataToServerString = dataToServerString + borders[i].land[j][0] + "/"
							dataToServerString = dataToServerString + borders[i].land[j][1] + ";"
						}
					}
				} else {
					dataToServerString = dataToServerString + borders[i].tag + ":"
					for (var j = 0; j < borders[i].land.length; j++){
						if(j != borders[i].land.length-1){
							dataToServerString = dataToServerString + borders[i].land[j][0] + "/"
							dataToServerString = dataToServerString + borders[i].land[j][1] + ","
						} else {
							dataToServerString = dataToServerString + borders[i].land[j][0] + "/"
							dataToServerString = dataToServerString + borders[i].land[j][1]
						}
					}
				}
			}
			console.log("start");
			console.log(borders);
			$.ajax({
				type:'post',
				url: address + "/databaseLink/saveborderdata/",
				data: {borders: dataToServerString},
				success: console.log("success"),
				error: console.log("error"),
			});
			console.log("end");
		}

		function loginToServer(){
			var username = document.getElementById("loginName").value;
			var password = document.getElementById("loginPassword").value;
			// Request to server with username and password in plaintext
			// TODO: make safe
			loginZeit = undefined;
			$.post({
				url: address + "/databaseLink/login/",
				data: {username:username, password:password},
				success: function(data){
					// saving the authenticationToken
					authenticationToken = data.token;
					// if the user is a GM, godmode possibility is displayed
					if(data.staff == true){
						document.getElementById("ToggleGodModeBar").style.display = "";
					}
					// overwrite old known data
					getNewDataFromServer();
				},
				dataType: "json"
			});
			// change loginBox to infoBox
			document.getElementById("infoBox").style.display = "";
			document.getElementById("loginBox").style.display = "none";
			
		}

		function logoutFromServer(){
			//loging out from server
			$.post({
				url: address + "/databaseLink/logout/"
			});
			// turning off godmode Box, and changing infoBox to Login Bog
			switchBtnBoxTo("buttonsBox");
			switchModeTo("none");
			// Hide gm functionalities
			document.getElementById("godmodeBox").style.visibility = "hidden";
			document.getElementById("ToggleGodModeBar").style.display = "none";
			document.getElementById("infoBox").style.display = "none";
			document.getElementById("loginBox").style.display = "";
			//change the info change box, back to the normal info Box
			document.getElementById("infoChangeBox").style.display = "none"
			// forget old authenticationToken
			authenticationToken = 0;
			// overwrite previously known data
			getNewDataFromServer();
			loginZeit = undefined;
		}

		// help function to fetch current data from the server
		function getNewDataFromServer(){
			loadMap(address);
		}

		function generateArmyBtn(){
			ownerBuffer = Number(document.getElementById("ownerField").value);
			armyIdBuffer = Number(document.getElementById("armyNumberField").value);
			countBuffer = Number(document.getElementById("countField").value);
			leaderBuffer = Number(document.getElementById("leaderField").value);
			mountsBuffer = Number(document.getElementById("mountsField").value);
			lkpBuffer = Number(document.getElementById("lkpField").value); 
			skpBuffer = Number(document.getElementById("skpField").value);
			guardBuffer = Boolean(document.getElementById("guardField").value);
			if(armyIdBuffer < 101 || armyIdBuffer > 399){
				window.alert("Die Armee-Id muss zwischen 101 und 399 liegen.");
				return false;
			}
			// check for any other armies with the same armyId
			for(var i=0; i < listOfArmyCoordinates.length; i++){
				if(listOfArmyCoordinates[i].a.armyId == armyIdBuffer && listOfArmyCoordinates[i].owner == ownerBuffer){
					window.alert("Ein Heer mit dieser Nummer existiert bereits in diesem Königreich.");
					return false;
				}
			}
			// check for catabults in a rider army, and for mounts in a rider army, or fleet
			if(Math.floor(armyIdBuffer/100) == 2) {
				if(mountsBuffer > 0 || lkpBuffer > 0 || skpBuffer > 0){
					window.alert("In einem Reiterheer sollten weder einzelne Reittiere, noch Katapulte sein. Wenn das Heer ein Fußheer sein sollte gib, ihm eine Nummer zwischen 100 und 199.")
					return false;
				}
			} else if (Math.floor(armyIdBuffer/100) == 3){
				if(mountsBuffer > 0){
					window.alert("In einer Flotte sollten keine Reittiere enthalten sein. Wenn das Heer ein Fußheer sein sollte, gib ihm eine Nummer zwischen 100 und 199.")
					return false;
				}
			}
			switchModeTo("armyWithNextClick");
		}

		function changeArmyInfo(){
			for(var i = 0; i<listOfArmyCoordinates.length; i++){
				if(i!=selectedArmy && listOfArmyCoordinates[i].owner == document.getElementById("ownerChangeInput").value &&
				listOfArmyCoordinates[i].a.armyId == document.getElementById("armyIdChangeInput").value){
					window.alert("Diese Armee-Id ist in diesem Reich bereits vergeben.");
				} else {
					listOfArmyCoordinates[selectedArmy].owner = Number(document.getElementById("ownerChangeInput").value);
					listOfArmyCoordinates[selectedArmy].a.armyId = Number(document.getElementById("armyIdChangeInput").value);
					listOfArmyCoordinates[selectedArmy].a.count = Number(document.getElementById("countChangeInput").value);
					listOfArmyCoordinates[selectedArmy].a.leaders = Number(document.getElementById("leadersChangeInput").value);
					listOfArmyCoordinates[selectedArmy].a.mounts = Number(document.getElementById("mountsChangeInput").value);
					listOfArmyCoordinates[selectedArmy].a.lkp = Number(document.getElementById("lkpChangeInput").value);
					listOfArmyCoordinates[selectedArmy].a.skp = Number(document.getElementById("skpChangeInput").value);
					listOfArmyCoordinates[selectedArmy].remainingMovePoints = Number(document.getElementById("movePointsChangeInput").value);
					listOfArmyCoordinates[selectedArmy].remainingHeightPoints = Number(document.getElementById("heightPointsChangeInput").value);
				}
			}
		}

		function updateInfoBox(){
			if(selectedArmy != undefined){
				// info Box
				console.log(listOfArmyCoordinates[selectedArmy].a.armyId);
				console.log(listOfArmyCoordinates[selectedArmy].a.isGuard);
				if(listOfArmyCoordinates[selectedArmy].a.isGuard){
					document.getElementById("guard").innerHTML = "GARDE";
				} else {
					document.getElementById("guard").innerHTML = null;
				}
				document.getElementById("armyId").innerHTML = "HeeresId: " + listOfArmyCoordinates[selectedArmy].a.armyId;
				document.getElementById("count").innerHTML = "anzahl Truppen: " + listOfArmyCoordinates[selectedArmy].a.count;
				document.getElementById("leaders").innerHTML = "anzahl Heerführer: " + listOfArmyCoordinates[selectedArmy].a.leaders;
				document.getElementById("mounts").innerHTML = "mitgeführte Reittiere: " + listOfArmyCoordinates[selectedArmy].a.mounts;
				document.getElementById("lkp").innerHTML = "leichte Katapulte: " + listOfArmyCoordinates[selectedArmy].a.lkp;
				document.getElementById("skp").innerHTML = "schwere Katapulte: " + listOfArmyCoordinates[selectedArmy].a.skp;
				document.getElementById("movePoints").innerHTML = "Verbleibende Bewegungspunkte: " + listOfArmyCoordinates[selectedArmy].remainingMovePoints;
				document.getElementById("heightPoints").innerHTML = "Verbleibende Höhenstufen: " + listOfArmyCoordinates[selectedArmy].remainingHeightPoints;
				if(Math.floor(listOfArmyCoordinates[selectedArmy].a.armyId/100) == 1){
					document.getElementById("mount").style.display = "";
					document.getElementById("unMount").style.display = "none";
				} else if(Math.floor(listOfArmyCoordinates[selectedArmy].a.armyId/100) == 2){
					document.getElementById("unMount").style.display = "";
					document.getElementById("mount").style.display = "none";
				} else {
					document.getElementById("mount").style.display = "none";
					document.getElementById("unMount").style.display = "none";
				}
				// change Box (GodMode)
				document.getElementById("ownerChangeInput").value = listOfArmyCoordinates[selectedArmy].owner;
				document.getElementById("ownerChange").style.display = "";
				document.getElementById("armyIdChangeInput").value = listOfArmyCoordinates[selectedArmy].a.armyId;
				document.getElementById("armyIdChange").style.display = "";
				document.getElementById("countChangeInput").value = listOfArmyCoordinates[selectedArmy].a.count;
				document.getElementById("countChange").style.display = "";
				document.getElementById("leadersChangeInput").value = listOfArmyCoordinates[selectedArmy].a.leaders;
				document.getElementById("leadersChange").style.display = "";
				document.getElementById("mountsChangeInput").value = listOfArmyCoordinates[selectedArmy].a.mounts;
				document.getElementById("mountsChange").style.display = "";
				document.getElementById("lkpChangeInput").value = listOfArmyCoordinates[selectedArmy].a.lkp;
				document.getElementById("lkpChange").style.display = "";
				document.getElementById("skpChangeInput").value = listOfArmyCoordinates[selectedArmy].a.skp;
				document.getElementById("skpChange").style.display = "";
				document.getElementById("movePointsChangeInput").value = listOfArmyCoordinates[selectedArmy].remainingMovePoints;
				document.getElementById("movePointsChange").style.display = "";
				document.getElementById("heightPointsChangeInput").value = listOfArmyCoordinates[selectedArmy].remainingHeightPoints;
				document.getElementById("heightPointsChange").style.display = "";
				document.getElementById("changeArmyInfo").style.display = "";
			} else {
				// info Box
				document.getElementById("guard").innerHTML = null;
				document.getElementById("armyId").innerHTML = null;
				document.getElementById("count").innerHTML = null;
				document.getElementById("leaders").innerHTML = null;
				document.getElementById("mounts").innerHTML = null;
				document.getElementById("lkp").innerHTML = null;
				document.getElementById("skp").innerHTML = null;
				document.getElementById("movePoints").innerHTML = null;
				document.getElementById("heightPoints").innerHTML = null;
				document.getElementById("mount").style.display = "none";
				document.getElementById("unMount").style.display = "none";
				// change Box (GM)
				document.getElementById("ownerChange").style.display = "none";
				document.getElementById("armyIdChange").style.display = "none";
				document.getElementById("countChange").style.display = "none"
				document.getElementById("leadersChange").style.display = "none"
				document.getElementById("mountsChange").style.display = "none"
				document.getElementById("lkpChange").style.display = "none"
				document.getElementById("skpChange").style.display = "none"
				document.getElementById("movePointsChange").style.display = "none"
				document.getElementById("heightPointsChange").style.display = "none"
				document.getElementById("changeArmyInfo").style.display = "none";
			};
		}

		function activateMountBox(){
			document.getElementById("infoBox").style.display = "none";
			document.getElementById("mountBox").style.display = "";
		}

		function activateUnMountBox(){
			document.getElementById("infoBox").style.display = "none";
			document.getElementById("unMountBox").style.display = "";
		}

		function cancelMountUnMount(){
			document.getElementById("mountBox").style.display = "none";
			document.getElementById("unMountBox").style.display = "none";
			document.getElementById("infoBox").style.display = "";
		}

		function mount(){
			var toMount = document.getElementById("mountInput").value;
			var leadersToMount = document.getElementById("mountLeaderInput").value;
			// genug Truppen vorhanden?
			if(toMount > listOfArmyCoordinates[selectedArmy].a.count){
				window.alert("Du hast zu wenige Truppen zum aufsitzen")
				return false;
			// genug Reittiere vorhanden?
			} else if(toMount > listOfArmyCoordinates[selectedArmy].a.mounts){
				window.alert("Du hast zu wenige Reittiere zum aufsitzen")
				return false;
			// Sitzen alle auf?
			} else if((toMount == listOfArmyCoordinates[selectedArmy].a.count)){
				// neues Reiterheer mit generierter Id an selben Koordinaten
				var newArmy = new reiterHeer(generateArmyId(2,listOfArmyCoordinates[selectedArmy].owner), toMount, listOfArmyCoordinates[selectedArmy].a.leaders, listOfArmyCoordinates[selectedArmy].a.isGuard);
				// Nachricht, falls Katapulte vorhanden waren.
				if(listOfArmyCoordinates[selectedArmy].a.skp > 0 || listOfArmyCoordinates[selectedArmy].a.lkp > 0){
					window.alert("Da kein Fußheer mehr Bestehen bleibt, wurden die Katapulte zerstört.")
				}
				// in listOfArmyCoordinates einfügen und alte Armee löschen, ist dann automatisch selectedArmy
				var newArmyCoordinates = new armyCoordinates(newArmy,listOfArmyCoordinates[selectedArmy].x,listOfArmyCoordinates[selectedArmy].y ,listOfArmyCoordinates[selectedArmy].owner);
				listOfArmyCoordinates.push(newArmyCoordinates);
				deleteSelectedArmy();
				cancelMountUnMount();
				updateInfoBox();
			// genug Heerführer?
			} else if(leadersToMount >= listOfArmyCoordinates[selectedArmy].a.leaders){
				window.alert("Du hast zu wenige Heerführer zum aufsitzen")
			} else if(listOfArmyCoordinates[selectedArmy].a.isGuard){
				window.alert("Die Garde muss zusammen bleiben");
			} else {
				// neues Reiterheer mit generierter Id an selben Koordinaten
				var newArmy = new reiterHeer(generateArmyId(2,listOfArmyCoordinates[selectedArmy].owner), toMount, leadersToMount, false);
				// zahlen im alten Heer anpassen
				listOfArmyCoordinates[selectedArmy].a.removeSoldiers(toMount);
				listOfArmyCoordinates[selectedArmy].a.removeLeaders(leadersToMount);
				listOfArmyCoordinates[selectedArmy].a.removeMounts(toMount);
				// in listOfArmyCoordinates einfügen
				var newArmyCoordinates = new armyCoordinates(newArmy,listOfArmyCoordinates[selectedArmy].x,listOfArmyCoordinates[selectedArmy].y ,listOfArmyCoordinates[selectedArmy].owner);
				listOfArmyCoordinates.push(newArmyCoordinates);
				// selectedArmy zeigt auf neues Heer
				selectedArmy = listOfArmyCoordinates.length-1;
				cancelMountUnMount();
				updateInfoBox();
			}
		}

		function unMount(){
			var toUnMount = document.getElementById("unMountInput").value
			var leadersToUnMount = document.getElementById("unMountLeaderInput").value;
			console.log(toUnMount);
			if(toUnMount > listOfArmyCoordinates[selectedArmy].a.count){
				window.alert("So viele Truppen hast du nicht zum absitzen")
				return false;
			// genug Truppen vorhanden?
			} else if((toUnMount == listOfArmyCoordinates[selectedArmy].a.count)){
				// neues Heer mit generierter Id an selben Koordinaten
				var newArmy = new heer(generateArmyId(1,listOfArmyCoordinates[selectedArmy].owner), toUnMount, listOfArmyCoordinates[selectedArmy].a.leaders, 0, 0, toUnMount, listOfArmyCoordinates[selectedArmy].a.isGuard);
				// in listOfArmyCoordinates einfügen und alte Armee löschen, ist dann automatisch selectedArmy
				var newArmyCoordinates = new armyCoordinates(newArmy, listOfArmyCoordinates[selectedArmy].x, listOfArmyCoordinates[selectedArmy].y, listOfArmyCoordinates[selectedArmy].owner);
				listOfArmyCoordinates.push(newArmyCoordinates);
				deleteSelectedArmy();
				cancelMountUnMount();
				updateInfoBox();
			// genug Heerführer?
			} else if(leadersToUnMount >= listOfArmyCoordinates[selectedArmy].a.leaders){
				window.alert("Du hast zu wenige Heerführer zum absitzen");
			} else if(listOfArmyCoordinates[selectedArmy].a.isGuard){
				window.alert("Die Garde muss zusammen bleiben");
			} else {
				// neues Heer mit generierter Id an selben Koordinaten
				var newArmy = new heer(generateArmyId(1,listOfArmyCoordinates[selectedArmy].owner), toUnMount, leadersToUnMount, 0, 0, toUnMount, false);
				// zahlen im alten Riterheer anpassen
				listOfArmyCoordinates[selectedArmy].a.removeSoldiers(toUnMount);
				listOfArmyCoordinates[selectedArmy].a.removeLeaders(leadersToUnMount);
				// in listOfArmyCoordinates einfügen
				var newArmyCoordinates = new armyCoordinates(newArmy, listOfArmyCoordinates[selectedArmy].x, listOfArmyCoordinates[selectedArmy].y, listOfArmyCoordinates[selectedArmy].owner);
				listOfArmyCoordinates.push(newArmyCoordinates);
				// selectedArmy zeigt auf neues Heer
				selectedArmy = listOfArmyCoordinates.length-1;
				cancelMountUnMount();
				updateInfoBox();
			}
		}

		function allMount(){
			// stellt ein, dass alle aufsitzen
			document.getElementById("mountInput").value = listOfArmyCoordinates[selectedArmy].a.count;
			// sitzt auf
			mount();
		}

		function allUnMount(){
			// stellt ein, dass alle aufsitzen
			document.getElementById("unMountInput").value = listOfArmyCoordinates[selectedArmy].a.count;
			// sitzt auf
			unMount();
		}

		function deleteSelectedArmy(){
			listOfArmyCoordinates[selectedArmy] = listOfArmyCoordinates[listOfArmyCoordinates.length-1]
			listOfArmyCoordinates.pop();
		}

		// returns the next armyId not yet assigned for the caller
		function generateArmyId(type, owner){
			if (type == 1){
				var j = 101;
				while(j<200){
					var found = false;
					for (var i = 0; i < listOfArmyCoordinates.length; i++){
						if(listOfArmyCoordinates[i].a.armyId == j && listOfArmyCoordinates[i].owner == owner){
							j++;
							found = true;
						}
					}
					if(found == false){
						return j;
					}
				}
				window.alert("Du hast die maximale Anzahl an Fußheeren erreicht.")
				return false;
			} else if (type == 2){
				var j = 201;
				while(j<300){
					var found = false;
					for (var i = 0; i < listOfArmyCoordinates.length; i++){
						if(listOfArmyCoordinates[i].a.armyId == j && listOfArmyCoordinates[i].owner == owner){
							j++;
							found = true;
						}
					}
					if(found == false){
						return j;
					}
				}
				window.alert("Du hast die maximale Anzahl an Reiterheeren erreicht.")
				return false;
			} else if (type == 3){
				var j = 301;
				while(j<400){
					var found = false;
					for (var i = 0; i < listOfArmyCoordinates.length; i++){
						if(listOfArmyCoordinates[i].a.armyId == j && listOfArmyCoordinates[i].owner == owner){
							j++;
							found = true;
						}
					}
					if(found == false){
						return j;
					}
				}
				window.alert("Du hast die maximale Anzahl an Flotten erreicht.")
				return false;
			} else {
				return false;
			}
		}
	</script>

</body>
</html>